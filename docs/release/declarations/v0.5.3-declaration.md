# Release Declaration: v0.5.3

> **This document is the source of truth for what this release contains.**
> The release audit agent will verify the PR against this declaration.
> Any deviation is a red flag that must be resolved before merge.

---

## Release Metadata

| Field       | Value                                      |
| ----------- | ------------------------------------------ |
| **Version** | `v0.5.3`                                   |
| **Type**    | `PATCH`                                    |
| **Branch**  | `hotfix/v0.5.3` or `release/v0.5.3-hotfix` |
| **Target**  | `main`                                     |
| **Date**    | 2025-12-25                                 |
| **Author**  | @markashton480                             |

---

## Statement of Intent

### What This Release IS

Fix the sync-to-public script to clone the public repo to `/tmp/sum-core-sync` instead of inside the repository, preventing accidental gitlink/submodule commits like the one that caused the `sum-core-public` incident.

### What This Release IS NOT

- ❌ NOT a feature release — no new functionality
- ❌ NOT including the 0.6.0 work (forms, blog categories, templates)
- ❌ NOT including any database migrations
- ❌ NOT including any new tests
- ❌ NOT including any template or static file changes

---

## Expected Scope

### Commits

| Expected Count | Tolerance |
| -------------- | --------- |
| `4`            | ±1        |

Expected commits:

1. `chore: remove accidental sum-core-public gitlink, add to gitignore`
2. `chore: exclude sum-core-public from linting tools`
3. `chore(sync): clone public repo to /tmp`
4. `chore(release): prepare v0.5.3`

### Lines Changed

| Expected    | Tolerance |
| ----------- | --------- |
| `+30 / -15` | ±50%      |

This is a minimal change — a few lines in the sync script, some pyproject.toml excludes, version bumps, and doc path updates.

### Files Changed

**Expected files (exhaustive list):**

```
.gitignore                                    # Add sum-core-public/
CHANGELOG.md                                  # Add v0.5.3 entry
pyproject.toml                                # Version bump + linter excludes
core/pyproject.toml                           # Version bump
core/sum_core/__init__.py                     # Version bump
boilerplate/requirements.txt                  # Pin to v0.5.3
cli/sum_cli/boilerplate/requirements.txt      # Pin to v0.5.3
scripts/sync_to_public.py                     # Change default path to /tmp
docs/ops-pack/RELEASE_RUNBOOK.md              # Update path references
docs/release/agent-prompt.md                  # Update path references
```

**Total: 10 files**

**Unexpected files (red flags if present):**

```
# Feature code — NONE of this should be in a patch
core/sum_core/blocks/*.py          # No new blocks
core/sum_core/forms/*.py           # No form changes
core/sum_core/pages/*.py           # No page changes

# Templates — NONE
themes/*/templates/**

# Static assets — NONE
themes/*/static/**

# Migrations — ABSOLUTELY NONE
*/migrations/*.py

# Tests — NONE (this is not a test release)
tests/**/*.py
```

---

## Version Checklist

| File                                       | Field         | Expected Value |
| ------------------------------------------ | ------------- | -------------- |
| `core/pyproject.toml`                      | `version`     | `0.5.3`        |
| `core/sum_core/__init__.py`                | `__version__` | `0.5.3`        |
| `pyproject.toml` (root)                    | `version`     | `0.5.3`        |
| `boilerplate/requirements.txt`             | git tag       | `v0.5.3`       |
| `cli/sum_cli/boilerplate/requirements.txt` | git tag       | `v0.5.3`       |
| `CHANGELOG.md`                             | latest entry  | `v0.5.3`       |

---

## Changelog Entry

**Required content:**

```markdown
## [v0.5.3] - 2025-12-25

### Changed

- Sync staging now defaults to `/tmp/sum-core-sync` to avoid accidental gitlinks; release docs updated.
```

**Prohibited content:**

- ❌ No `### Added` section (this is a PATCH)
- ❌ No mention of forms, blog, templates, or any 0.6.0 features
- ❌ No `### Breaking` section

---

## Pre-Merge Verification

- [x] PR title matches: `Release v0.5.3 (hotfix)`
- [x] Branch name matches: `release/v0.5.3-hotfix`
- [x] Commit count within tolerance: 4 commits ✓
- [x] Lines changed within tolerance: +25/-15 ✓
- [x] All expected files present: 10/10 ✓
- [x] No unexpected files present: ✓
- [x] All version references consistent: ✓
- [x] Changelog entry matches intent: ✓
- [x] CI passes: ✓

---

## Sign-Off

| Role    | Name                 | Date       | Approved |
| ------- | -------------------- | ---------- | -------- |
| Author  | @markashton480       | 2025-12-25 | ☑        |
| Auditor | Claude (Audit Agent) | 2025-12-25 | ☑        |

---

## Audit Log

```
[2025-12-25 14:30] Audit by: Claude (Release Audit Agent)
PR: #156
Result: PASS
Notes:
- 4 commits (expected 4 ±1) ✓
- +25/-15 lines (expected +30/-15 ±50%) ✓
- 10 files changed, all expected ✓
- No unexpected files ✓
- All versions consistent at 0.5.3 ✓
- Changelog matches intent ✓
- CI passed ✓
Verdict: Safe to merge.
```

---

## Comparison: What PR #154 Would Have Failed

For reference, here's what the audit would have shown for the bad PR:

| Check            | Expected | PR #154 Actual | PR #156 Actual |
| ---------------- | -------- | -------------- | -------------- |
| Commits          | 4 ±1     | 26 ❌          | 4 ✅           |
| Lines added      | +30 ±50% | +3,856 ❌      | +25 ✅         |
| Lines removed    | -15 ±50% | -96 ❌         | -15 ✅         |
| Files            | 10       | 40 ❌          | 10 ✅          |
| Unexpected files | 0        | 30 ❌          | 0 ✅           |

**PR #154 would have been flagged as HARD FAIL immediately** based on the 128x line count deviation alone.
