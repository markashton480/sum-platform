# M2-011 – Standard Content Page Type (`StandardPage`)

### 1. Context (from PRD)

**Business requirement (paraphrased)**
The platform must support generic content pages (e.g. About, FAQ, Terms, Service Overview) that can be composed from the same reusable StreamField blocks as the homepage. Editors should be able to create and reorder sections without developer involvement, while keeping visuals consistent with the SUM design system.

**Relevant user stories**

* **US-P02 – Standard Content Page**:

  * As a marketer, I can create standard content pages using the same blocks as the homepage (hero, trust, testimonials, content, etc.).
  * As a marketer, I can manage page titles, SEO, and basic settings without developer help.
* **Epic: Blocks & Components**: All core blocks (hero, trust strip, testimonials, content, portfolio, etc.) should be usable on multiple page types, not just the homepage.

This task is the first step toward hitting the Milestone 2 DoD of “4 page types creatable in admin” and “content system complete”.

---

### 2. Technical Requirements

**Objective**
Introduce a reusable **Standard Content Page** that:

* Lives in `sum_core` (not just the test project) so it can be reused by real client sites.
* Uses the **existing `PageStreamBlock`** so all current blocks are available.
* Uses the **shared layout (`sum_core/base.html`)** and section patterns.
* Requires minimal extra styling – the visual responsibility remains with the blocks.

**Key requirements**

1. **New page model**

   * Create `StandardPage` as a `wagtail.models.Page` subclass in a new or existing `sum_core` pages module:

     * Suggested structure:

       * `core/sum_core/pages/__init__.py`
       * `core/sum_core/pages/standard.py`
     * Use an `AppConfig` for the app:

       * `core/sum_core/pages/apps.py` (`PagesConfig` with label e.g. `"sum_core_pages"`).
   * Fields:

     * `body = StreamField(PageStreamBlock, use_json_field=True, blank=True)`
     * No extra hero/CTA fields for now – hero & CTAs are blocks.
   * Wagtail config:

     * `parent_page_types = ["wagtailcore.Page"]` OR a sensible limited parent set (e.g. `["home.HomePage"]` or a site root type) – keep flexible enough for test project.
     * `subpage_types = []` for now (this is a leaf content page).
     * `template = "sum_core/standard_page.html"`.

2. **Template**

   * Create `core/sum_core/templates/sum_core/standard_page.html`:

     * Extends `sum_core/base.html`.
     * Uses the **standard section structure** from `design-implementation.md` for the page header if you include one.
     * Renders `page.body` using `{% include_block %}` inside a `<main>` region.
   * Page header:

     * Optional but recommended: a simple page header at the top, using typography tokens:

       * Title uses `.heading-xl`.
       * Optional intro/standfirst (if you add a RichText or CharField later; for now can be omitted).
     * Respect tokens for spacing and colors (no bespoke hex/px).

3. **App wiring**

   * Add `'sum_core.pages'` (or the chosen app label) to:

     * `core/sum_core/test_project/test_project/settings.py` → `INSTALLED_APPS`.
   * Ensure migrations are generated for the new app if necessary:

     * Migration files should live under `core/sum_core/pages/migrations/`.

4. **Use existing StreamField blocks**

   * `PageStreamBlock` should already expose:

     * Hero block(s), trust strip, services, testimonials, process/FAQ, content blocks, portfolio, etc.
   * **Do not** define any new blocks in this task.
   * Confirm `StandardPage` is using **the same `PageStreamBlock` class** as `HomePage`.

5. **Docs**

   * Add an entry for `StandardPage` to:

     * `docs/blocks-reference.md` (if it already exists) OR create a brief note in whatever central doc you’re using for pages/blocks:

       * Explain that it uses `PageStreamBlock` and is intended for generic content pages.

---

### 3. Design Specifications

This task is intentionally **light on new visual requirements**. The idea is that:

* All **visual style** is driven by the existing blocks and their component CSS (`components.*.css`) plus the layout and typography CSS.
* `StandardPage` just provides the page shell and ensures the output is structurally sound.

**Page layout**

* Base:

  * `standard_page.html` must:

    * Extend `sum_core/base.html`.
    * Put content inside the main layout region (`block content`).
* Optional page header pattern (if implemented now):

  * Follow the pattern from `design-implementation.md`:

    ```html
    <section class="section">
      <div class="container">
        <header class="section__header">
          <div class="section__heading">
            <h1 class="heading-xl">{{ page.title }}</h1>
          </div>
        </header>
      </div>
    </section>
    ```
  * No custom fonts or sizes.

**Tokens & classes**

* Use **only** classes and tokens defined in:

  * `core/sum_core/static/sum_core/css/tokens.css`
  * `core/sum_core/static/sum_core/css/typography.css`
  * `core/sum_core/static/sum_core/css/layout.css`
* **Do not** introduce new colors or spacing scales for the page wrapper; rely on existing `.section` + `.container` + typography.

---

### 4. Implementation Guidelines

**Files to create/modify**

* New:

  * `core/sum_core/pages/__init__.py`
  * `core/sum_core/pages/apps.py`
  * `core/sum_core/pages/standard.py`
  * `core/sum_core/pages/migrations/0001_initial.py` (or next migration).
  * `core/sum_core/templates/sum_core/standard_page.html`
* Existing:

  * `core/sum_core/test_project/test_project/settings.py` → `INSTALLED_APPS` entry.
  * `docs/blocks-reference.md` or equivalent docs file (brief entry).

**Required header comments (Python)**

For each new Python module:

```python
"""
Name: [Module Name]
Path: [File path]
Purpose: [Brief description]
Family: SUM Platform – Page Types
Dependencies: Wagtail Page model, sum_core.blocks.base.PageStreamBlock
"""
```

* Use type hints on all methods and fields where possible (e.g. `def get_context(self, request: HttpRequest) -> Dict[str, Any]: ...` if you override anything).

**Patterns to follow**

* Stick to **existing patterns** from `HomePage` and any current page models:

  * Panels, template naming, and `content_panels` style.
* Use `StreamField` with `use_json_field=True` for Wagtail 5+ / Django 5 compatibility.
* Don’t introduce custom save logic, routes, or mixins in this task.

---

### 5. Acceptance Criteria

For this task to be considered complete:

1. **Model & Admin**

   * [ ] `StandardPage` appears as a creatable page type in the Wagtail admin.
   * [ ] Editors can create a `StandardPage` under a sensible parent (e.g. site root or HomePage).
   * [ ] `StandardPage` has a `body` StreamField using `PageStreamBlock`.

2. **Rendering**

   * [ ] Visiting a `StandardPage` URL renders successfully with:

     * SUM layout (header/footer from `base.html`).
     * Any blocks added to `body` rendered via `{% include_block %}`.
   * [ ] If a page header is implemented:

     * The page title renders using `.heading-xl` and token-based spacing.
   * [ ] No inline styles or hard-coded hex/px values in `standard_page.html`.

3. **Integration with existing blocks**

   * [ ] At least one example `StandardPage` in tests renders:

     * A hero block.
     * One other block (e.g. services, testimonials, or content block).
   * [ ] Rendering structure is compatible with existing block CSS (no unexpected wrappers breaking layout).

4. **Tests**

   * [ ] New unit/integration tests exist for `StandardPage` (see Testing Requirements).
   * [ ] `make test` passes.
   * [ ] `make lint` passes.

---

### 6. Dependencies & Prerequisites

**Depends on:**

* M2-001 – Blocks infrastructure & `PageStreamBlock`.
* All implemented blocks used by `PageStreamBlock` (hero, services, testimonials, process/FAQ, content, portfolio, etc.).
* Milestone 1 base templates and CSS token system.

**Assumptions**

* The current `HomePage` is already wired to use `PageStreamBlock` and is working as the site root.
* No multi-site or multi-locale complexity for this task (single-site test project is fine).

---

### 7. Testing Requirements

**Unit / model tests**

Create a new test module, for example:

* `tests/pages/test_standard_page.py`

Test cases:

1. **Model registration**

   * `StandardPage` is registered as a Wagtail page type.
   * `StandardPage` has a `body` field that is a `StreamField` with `PageStreamBlock`.

2. **Page creation**

   * Use a Wagtail root page or `HomePage` fixture to:

     * Create and save a `StandardPage` with a minimal `body` (e.g. a single hero block or content block).
   * Assert that `StandardPage` can be saved and published without error.

**Template / rendering tests**

* Add to `tests/templates/test_standard_page_rendering.py` (or similar):

  * Build a `StandardPage` with:

    * At least one hero block.
    * One other block (e.g. services or content).
  * Use Django test client or Wagtail test utilities to fetch the page.
  * Assert:

    * HTTP 200.
    * Presence of the block-specific classes in the response HTML (e.g. `.hero`, `.service-cards`, `.content-block`).
    * If a page header exists, presence of `.heading-xl` around the title.

**Manual testing checklist**

* [ ] In Wagtail admin, create a `StandardPage` under the site root or `HomePage`.
* [ ] Add a small mix of blocks (hero, trust strip, testimonials, content block).
* [ ] Publish and view:

  * Layout should look coherent; sections follow existing styling.
  * Changing fonts/colors in `SiteSettings` updates the appearance as expected (since blocks use tokens).
* [ ] Verify no console errors, template errors, or missing static assets.

---

### 8. Estimated Complexity

* **Time**: **M** (Medium)
* **Risk**: **Low–Medium**

  * Low from a code perspective (standard Wagtail pattern).
  * Medium in terms of **architectural impact**, because this becomes a foundational page type that other tasks/milestones will rely on.

