Yep — you’re right. Here it is rewritten **using `task_ticket_template.md` exactly** (and keeping it strictly corrective so we’re back on-plan).

---

# **CM-M6-A-004: Theme A Component Classes Missing From Compiled CSS**

## **Objective**

Restore M6-A correctness by ensuring **all Theme A component classes referenced by Theme A templates** (e.g. `.btn`, `.hero--gradient`, `.footer__grid`) are **defined in Tailwind input and present in the compiled CSS** served to client sites.

---

## **Context**

Manual sanity-check of a freshly initialised client (`clients/acme`) using `--theme theme_a` shows:

* Theme A CSS loads and Tailwind utilities apply (computed font + body colour correct).
* Theme templates include semantic/component classes (`.btn`, `.btn-primary`, `hero--gradient`, `footer__grid`, etc.).
* These selectors **do not exist** in the compiled Theme A CSS, so core elements render visually “unstyled”.

This is a **corrective task to complete M6-A properly**, not M6-B scope.

* Business requirement excerpt: Theme system must deliver a real theme reliably (Theme A reference theme).
* Relevant user story: As a site builder, I can `sum init --theme theme_a` and immediately see Theme A’s intended presentation.
* Reference: `POST-MVP_BIG-PLAN.md` §6.1 (Tailwind-first theme system), §6.2 (Theme vs Branding contract)

---

## **Git Plan (MANDATORY)**

This task **must** follow the project Git strategy.

* **Base branch:** `develop`
* **Working branch (agent must create and use):**
  `fix/cm-m6-a-004-theme-a-component-css`
* **Commits**

  * WIP commits are allowed during development
  * Final commit(s) should reference the task ID where sensible
    e.g. `fix(theme_a): [CM-M6-A-004] add component layer selectors`
* **Pull Request**

  * Target branch: `develop`
  * PR title format: `fix(theme_a): [CM-M6-A-004] restore missing component selectors`
  * PR description **must include**:

    * Summary of changes
    * Tests run (commands + results)
    * Risk / rollback notes (what could break)

---
Do *NOT* PR until approved.

## **Technical Requirements**

1. **Identify** all component selectors referenced by Theme A templates that are currently missing from compiled CSS (minimum set includes):

   * `.btn`, `.btn-primary` (and any other `.btn-*` used in templates)
   * `.hero--gradient`, `.hero--gradient-primary`
   * `.footer__grid` and related `footer__*` classes used in templates
2. **Implement** these selectors in the Tailwind input CSS using `@layer components` (and `@apply` where appropriate) so they compile deterministically into Theme A’s output.
3. **Rebuild** the compiled Theme A CSS and ensure it is the file served by clients.
4. **Update guardrails/tests** so this cannot regress:

   * Add assertions that the compiled CSS contains the required selectors.
5. Maintain the Theme vs Branding contract:

   * Do not hardcode client branding; consume existing CSS variables.

* Reference: `POST-MVP_BIG-PLAN.md` §6.1, §6.2

---

## **Design Specifications**

* No redesign. This is parity/restore work.
* Ensure:

  * Buttons visibly styled (primary CTA looks intentional)
  * Hero gradient variant visually applies (background/gradient present)
  * Footer grid layout applies (columns/spacing consistent)
* Responsive behaviour must remain intact.
* Accessibility: do not remove existing focus-visible behaviour; ensure button/link focus styling remains.

---

## **Implementation Guidelines**

* Files to create or modify (expected):

  * `core/sum_core/themes/theme_a/static/theme_a/css/input.css` (or theme Tailwind input file)
  * `core/sum_core/themes/theme_a/static/theme_a/css/main.css` (compiled output, regenerated)
  * Theme fingerprint file used by guardrails (regenerated)
  * Theme guardrail tests (e.g. under `tests/…`)

* Required header comments on all new or modified Python modules:

```python
"""
Name: [Module Name]
Path: [File path]
Purpose: [Brief description]
Family: [What depends on this]
Dependencies: [What this depends on]
"""
```

* Python code must include type hints
* Follow patterns defined in `POST-MVP_BIG-PLAN.md`
* Keep changes **strictly scoped** to this ticket
  (no drive-by refactors unless explicitly approved here)

---

## **Acceptance Criteria**

#### **Functional**

* [ ] All Theme A component selectors referenced by templates are present in compiled CSS:

  * [ ] `.btn`
  * [ ] `.btn-primary`
  * [ ] `.hero--gradient`
  * [ ] `.hero--gradient-primary`
  * [ ] `.footer__grid` (+ any other `footer__*` used)
* [ ] Fresh client init with `--theme theme_a` renders hero + CTA + footer with intended styling.
* [ ] No legacy core CSS import reintroduced.
* [ ] No unrelated behaviour changes introduced.

### **Code Quality**

* [ ] Header comments present on all new/modified Python modules
* [ ] Python type hints included and correct
* [ ] DRY principles respected (no unnecessary duplication)
* [ ] Clear, readable naming consistent with SSOT

### **Testing**

* [ ] Tests added/updated per `test-strategy-v1.1.md` (risk: branding/theming breakage)
* [ ] Guardrail test fails if any required selector is missing from compiled CSS
* [ ] All tests pass locally
* [ ] Agent explicitly lists test commands run and results

### **Git & PR (REQUIRED TO COMPLETE TASK)**

* [ ] Task branch created from `develop` (`fix/cm-m6-a-004-theme-a-component-css`)
* [ ] All work committed to the task branch


### **Work Report Evidence**

* [ ] `git status`
* [ ] `git log -n 5 --oneline`
* [ ] High-level list of files changed
* [ ] Notes on anything surprising or risky
* [ ] Comprehensive industry-standard work report
* [ ] File under `CM-M6-A-004_followup.md` in the same directory as the task ticket.

--

## **Dependencies & Prerequisites**

* M6-A Theme toolchain + init/check wiring must already exist (this task assumes it).
* Dev environment able to run theme build scripts (Node deps available) and Django client runserver.

---

## **Testing Requirements** (from `test-strategy-v1.1.md`)

* Unit/guardrail tests:

  * Assert compiled CSS contains required selectors listed above.
* Integration/manual checklist:

  * `sum init acme --theme theme_a`
  * Run `python manage.py runserver`
  * Confirm hero gradient, CTA button styling, footer grid layout
  * Confirm focus-visible styling still works on links/buttons
* Coverage expectations:

  * Add targeted assertions; do not attempt broad CSS snapshotting.

---

## **Estimated Complexity**

* **Time:** M
* **Risk:** Medium (touches theme CSS pipeline + guardrail tests)
* **Suggested Model:**
  Claude Sonnet / GPT-5.1 (Medium complexity)

---
