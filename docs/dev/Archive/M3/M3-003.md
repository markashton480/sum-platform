 **[M3-003] Enforce single HomePage and root-only creation**

**Context** (from PRD)

* Business requirement excerpt: “Only one HomePage allowed per site (enforced)”
* Relevant user story: “As a content editor, I want a flexible homepage…”

**Technical Requirements** (from Tech Spec / current implementation patterns)

* Enforce the “single home page” rule at the model layer (not just in admin UI), so programmatic creation can’t bypass it.
* Ensure `HomePage` can only be created directly under the Wagtail root node (to prevent nested/duplicate homepages in the tree).
* Tests must include a **negative case** (attempt to create a second HomePage) per our testing philosophy and coverage goals (≥80%).

**Design Specifications** (from Design References)

* No frontend/UI changes required for this task (admin behavior + validation only).

**Implementation Guidelines**

* **Files to modify**

  * `core/sum_core/test_project/home/models.py`
  * `tests/pages/test_home_page.py`
* Required header comments on any touched/created modules (keep existing header intact).
* Python: include type hints; follow existing Wagtail patterns used in Milestone 3

**What to implement**

1. **Root-only creation**

   * Override `HomePage.can_create_at(parent)` (or `can_exist_under`) to only allow creation when `parent` is the Wagtail root node.
   * Keep `parent_page_types` consistent with the intended behavior (or remove misleading comments).
2. **True “single HomePage” enforcement**

   * Replace the current “root_page defensive check” with a real constraint:

     * In `clean()`: if any other `HomePage` exists (`HomePage.objects.exclude(pk=self.pk).exists()`), raise `ValidationError` with a clear message.
   * Remove now-misleading logic/commentary that implies Site.root_page uniqueness “enforces” the rule.
3. **Tests**

   * Add a negative test that attempts to create a second `HomePage` and asserts a `ValidationError`.
   * Add a test that `HomePage.can_create_at(non_root_parent)` is False (and True for root).

**Acceptance Criteria**

* Attempting to create a second `HomePage` (via model validation) raises a `ValidationError` matching the “only one” rule.
* `HomePage` cannot be created under non-root parents (enforced via `can_create_at`/`can_exist_under`).
* All tests pass; new tests cover both the positive and negative paths.

**Dependencies & Prerequisites**

* Milestone 3 tasks M3-001 and M3-002 completed (mixins + HomePage exist).

**Testing Requirements**

* Unit tests in `tests/pages/test_home_page.py`:

  * ✅ can create first homepage under root
  * ✅ cannot create homepage under non-root
  * ✅ cannot create second homepage (raises ValidationError)
* Manual sanity check:

  * In Wagtail admin, “Add child page” should not offer `HomePage` anywhere except root; after one exists, it should not be addable.

**Estimated Complexity**

* Time: **S**
* Risk: **Low** (localized behavior change + tests)
