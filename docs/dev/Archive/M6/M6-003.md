**[MILESTONE-006]: M6-003 — Theme A (Sage & Stone) Implementation Against Compiled HTML Contract**

**Objective**: Implement **Theme A** as the first “real” theme (not a skeleton) by translating the **compiled Sage & Stone HTML artifacts** into a Wagtail/Django theme that ships in `sum_core`, is copied into `theme/active/` at `sum init`, and renders the existing SUM page types with matching structure, styling, and interactions.

---

## Context

**Business requirement excerpt (Post-MVP):** Themes are the mechanism for repeatable layout + component structure across sites, with branding staying editable via Wagtail settings.

**Platform contract + stability:**

- `0.5.x` frozen; `0.6.x` is where themes/blog/forms land.
- Themes must live in `sum_core/themes/...` (no new apps / parallel structures).
- Runtime theme loading is **copy-into-client** (`theme/active/`), provenance recorded in `.sum/theme.json`.

**UI Contract Sources (compiled HTML artifacts):**

- Global interactions/styles: `style.css`, `script.js`
- Example header/mega menu markup present across pages (e.g. `about.html`, `services.html`, `portfolio.html`).
- Blog listing contract: category badge + date + reading time + card layout + filters/search UI patterns exist in `blog_list.html`.

**Reference docs:**

- `POST-MVP_BIG-PLAN.md` — Milestone 6 (Themes), Blog UI contract notes (to keep Theme A compatible).
- `SUM-PLATFORM-SSOT.md` — page mix + allowed structure expectations.
- `test-strategy-v1.1.md` — testing bar + coverage philosophy.

---

## Technical Requirements

### Architecture / constraints (non-negotiable)

- **Do not touch / destabilise** M5 / `0.5.x` behaviours (Theme A is additive in the `0.6.x` line).
- Theme A must be **authored in**:
  `core/sum_core/themes/theme_a/` (source-of-truth theme shipped in the platform).
- Theme A must be **consumable via copy** into client projects at `sum init`, landing in:
  `theme/active/...` (this is already wired; do not re-architect it).
- **Forbidden:** new top-level apps/packages, duplicated parallel feature structures, or “theme logic” that bleeds into models.

### What to build in Theme A (deliverables)

1. **Templates (Theme A)**

   - Implement Theme A equivalents for existing SUM page templates, using the Sage & Stone compiled HTML as the structural contract.
   - Create/adjust includes:

     - `includes/header.html` must match the desktop header + mega menu structure and IDs expected by JS (`kitchens-nav`, `kitchens-trigger`, `mega-menu-kitchens`, `main-header`).
     - `includes/footer.html`
     - Any shared UI partials required for parity (banner, announcement bar, etc.) where present in compiled pages.

   - Ensure template blocks are clean and theme-friendly (no business logic; only presentation wiring).

2. **Static assets**

   - Port `style.css` into Theme A static (or merge into a Theme A `main.css`) while preserving:

     - reveal animation classes (`.reveal`, `.reveal.active`)
     - mega menu CSS bridge/physics (`.mega-panel` behaviour)
     - mobile menu transitions
     - reduced-motion fallbacks

   - Port `script.js` into Theme A JS bundle (`main.js`) keeping:

     - mega menu intent logic + keyboard escape behaviour
     - reveal animation + parallax behaviour
     - modal helpers + scroll locking (if those components exist in templates)

3. **Blog compatibility (forward-compat)**

   - Even though Blog models may land in the next ticket, Theme A should include _styling + template scaffolding patterns_ needed to render the blog listing/article UI contract cleanly later.
   - The listing UI contract includes category badge + date + reading time + card layout, plus the filter bar markup pattern.

---

## Design Specifications

- Fidelity target: **structure and interactions** should match the compiled artifacts (header behaviour, reveal animations, etc.), not “approximate”.
- Accessibility: respect focus-visible styles and reduced-motion rules already present in the compiled CSS.
- No template CDN dependencies (no Tailwind CDN script tags). Theme static assets must be served via Django static.

---

## Implementation Guidelines

### Files to create/modify (indicative)

- `core/sum_core/themes/theme_a/templates/theme_a/base.html`
- `core/sum_core/themes/theme_a/templates/theme_a/includes/header.html`
- `core/sum_core/themes/theme_a/templates/theme_a/includes/footer.html`
- `core/sum_core/themes/theme_a/templates/theme_a/*.html` for page types you need to theme now
- `core/sum_core/themes/theme_a/static/theme_a/css/main.css` (or equivalent)
- `core/sum_core/themes/theme_a/static/theme_a/js/main.js` (or equivalent)

**Keep Python changes minimal** in this ticket. If you _must_ add helpers, follow the header comment standard and type hints (but prefer not to).

### Testing Requirements (from `test-strategy-v1.1.md`)

- Add **integration-style rendering tests** proving key pages render with Theme A selected, and that critical DOM hooks exist (e.g. mega menu IDs, header ID).
- Coverage expectation: keep ≥80% overall for touched/new code areas (don’t tank the gate).
- Manual verification checklist:

  - `sum init --theme theme_a …` creates a project and copies theme into `theme/active/`.
  - Run dev server; confirm header scroll effect + mega menu open/close + reveal animations (where present).

---

## Acceptance Criteria

- [ ] Theme A templates render the existing SUM page types with Sage & Stone structure (header/footer/layout consistent with compiled pages).
- [ ] Theme A includes the compiled interaction hooks (IDs/classes) needed by `script.js` mega menu + reveal logic.
- [ ] Theme A ships static assets equivalent to `style.css` and `script.js` behaviour (no CDN dependencies).
- [ ] Rendering tests added for at least: HomePage + StandardPage (or whichever are simplest to instantiate) asserting presence of critical hooks and that response is 200.
- [ ] `make test` and `make lint` pass.

---

## Dependencies & Prerequisites

- ✅ M6-002 theme system exists, and ✅ CM-M6-03 copy-into-client model is in place (do not rewrite it).
- Use compiled HTML artifacts as the UI contract input set (not Jinja partials).

---

## Estimated Complexity

- **Time**: L
- **Risk**: Medium (mostly template/asset integration + avoiding unintended coupling)
- **Suggested Model**: GPT-5.2 (High complexity) or Claude Sonnet (Med/High)

---
