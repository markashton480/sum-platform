- [M6-A-001]: Establish Theme A Tailwind Toolchain (Compiled Output, No Runtime Dependency)\*\*

## **Objective**

Implement a **maintainer-only Tailwind build pipeline for Theme A** that produces **compiled CSS shipped with the theme**, removes legacy core CSS bleed, and guarantees that any site created via `sum init --theme theme_a` renders correctly **without requiring Node or a build step at runtime**.

This task establishes the **Theme Toolchain v1 contract** for SUM v0.6 and is a prerequisite for all future theme work.

---

## **Context**

### Business / Platform Context

- SUM v0.6 introduces a **new theme rendering contract** (ADR-002): themes are first-class owners of layout, templates, and styling.
- Theme A is the **reference implementation** for all future themes.
- Tailwind has been adopted as the **authoring system** for themes, but **must not introduce runtime friction** for `sum init`.

Relevant sources:

- `decisions.md` - ADR-002
- `POST-MVP_BIG-PLAN.md` — Milestone 6 (Themes & Delivery Pipeline)
- `THEME-ARCHITECTURE-SPECv1.md` — Tailwind-first themes, branding via CSS variables

### Problem Being Solved

Currently:

- Theme A templates rely on Tailwind utility classes.
- No Tailwind build exists → utilities are not compiled.
- Core CSS is imported as a fallback → legacy styling bleeds through.
- This violates the v0.6 theme ownership contract and causes silent regressions.

This task fixes the **missing system layer**, not a cosmetic issue.

---

## **Technical Requirements**

### Core Contract (Non-Negotiable)

1. **Theme A ships with compiled CSS**

   - The file linked by templates (`static/theme_a/css/main.css`) must be **compiled Tailwind output**, committed to the repo.

2. **No runtime Tailwind dependency**

   - Running a site must not require Node, npm, or a build step.

3. **Tailwind is maintainer-only tooling**

   - Node/Tailwind is used _only_ when authoring or updating the theme.

### Tailwind Build Setup

- Add Tailwind configuration under:

  ```
  sum_core/themes/theme_a/
  ```

- Tailwind **content scan paths** must include:

  - `sum_core/themes/theme_a/templates/**/*.html`
  - (no client paths at this stage)

### CSS Structure

- Create a Tailwind **input file**, e.g.:

  ```
  static/theme_a/css/input.css
  ```

  containing:

  ```css
  @tailwind base;
  @tailwind components;
  @tailwind utilities;

  /* bespoke theme CSS (mega menu, reveal, a11y, etc.) */
  ```

- Generate compiled output to:

  ```
  static/theme_a/css/main.css
  ```

- **Do not hand-edit `main.css`** (generated artifact).

### Branding Compatibility

- Tailwind config must map theme colours to **CSS variables** (e.g. `rgb(var(--color-primary) / <alpha-value>)`) so:

  - Branding changes via SiteSettings do **not** require rebuilding CSS.

### Legacy Cleanup

- **Remove** any import of:

  ```
  /static/sum_core/css/main.css
  ```

  from Theme A stylesheets.

- Theme A CSS becomes the **sole styling authority**.

---

## **Design Specifications**

- No visual redesign in this task.
- Success is measured by:

  - Tailwind utilities (e.g. `flex`, `px-*`, `mx-auto`) applying correctly.
  - Header/nav rendering correctly without legacy bleed.

- Hero and other legacy class usage may remain temporarily; this task only ensures the toolchain works.

---

## **Implementation Guidelines**

### Files to Create / Modify (Indicative)

- `sum_core/themes/theme_a/tailwind.config.js`
- `sum_core/themes/theme_a/postcss.config.js` (if required)
- `sum_core/themes/theme_a/static/theme_a/css/input.css`
- `sum_core/themes/theme_a/static/theme_a/css/main.css` (generated, committed)
- Remove legacy CSS imports from any Theme A stylesheets.

### Required Header Comments

All new non-generated files must include:

```python
"""
Name: <Module Name>
Path: <File path>
Purpose: <Why this file exists>
Family: Theme A
Dependencies: Tailwind (authoring only)
"""
```

### Versioning

- Pin Tailwind and related tooling versions.
- Commit lockfile to prevent build drift.

---

## **Acceptance Criteria**

1. **Compiled Tailwind CSS exists**

   - `static/theme_a/css/main.css` is present and non-trivial in size.

2. **Tailwind utilities apply**

   - At least one deterministic utility rule (e.g. `.flex { display: flex; }`) exists in compiled output.

3. **No legacy CSS bleed**

   - `/static/sum_core/css/main.css` is not imported by Theme A.

4. **Runtime works without Node**

   - A site using Theme A renders correctly without running any build commands.

5. **Branding tokens still function**

   - Changing SiteSettings variables affects colours without rebuilding CSS.

---

## **Testing Requirements** (per `test-strategy-v1.1.md`)

### Automated

- Add a test or check that asserts:

  - Theme A compiled CSS exists.
  - Compiled CSS contains a known Tailwind signature.

- Test must fail loudly if CSS is missing or empty.

### Manual

- Apply Theme A to a smoke-test site.
- Verify:

  - Header layout styles correctly.
  - No legacy button styles appear.
  - No console or static asset errors.

---

## **Dependencies & Prerequisites**

- ADR-002 accepted.
- Theme A templates already reference `static/theme_a/css/main.css`.
- No client-side theme overrides required at this stage.

---

## **Estimated Complexity**

- **Time**: M
- **Risk**: Medium (foundational, but contained)
- **Suggested Model**: GPT-5.2 / Claude Opus (high-confidence system work)
