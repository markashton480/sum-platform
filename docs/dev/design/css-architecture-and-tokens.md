# SUM Platform – CSS & Design System Guide

> **Purpose:**
> One place to understand **how CSS is structured** in `sum_core` and **how to use design tokens** when implementing or updating blocks. This is for both humans and AI agents.

---

## 1. Goals

- **Single source of truth for design values** (tokens).
- **Consistent implementation** across all blocks (hero, services, testimonials, etc.).
- **Brand-driven**: colours and typography are controlled by Wagtail `SiteSettings` via `branding_css` and `branding_fonts`.
- **Modular CSS** that’s easy to navigate and extend.

---

## 2. CSS Architecture

All CSS lives under:

`core/sum_core/static/sum_core/css/`

Target structure (names can be adjusted as long as the roles stay clear):

```text
css/
  tokens.css        # Design tokens: colours, type scale, spacing, shadows, easings
  base.css          # Reset, html/body, base typography, links
  layout.css        # Layout shell, .section, .container, grids
  utilities.css     # Small helpers (.visually-hidden, text utilities, etc.)
  animations.css    # Reveal animations & transitions

  components/
    buttons.css
    forms.css
    cards.css
    header.css
    footer.css
    hero.css
    services.css
    testimonials.css
    # future: trust-strip.css, cta.css, faq.css, portfolio.css, etc.

  main.css          # Single entrypoint loaded by templates
```

**Key rules**

- Templates **only ever reference** `main.css`.
  `base.html` must continue to link to `sum_core/css/main.css` as the single stylesheet.
- `main.css` is responsible for importing/aggregating the partials in the correct order (tokens → base → layout → utilities → animations → components).
- Component files **do not** declare new tokens; they only **consume** tokens.

`main.css` (conceptually) looks like:

```css
/* ==========================================================================
   SUM Platform Design System – CSS entrypoint
   ========================================================================== */

@import "tokens.css";
@import "base.css";
@import "layout.css";
@import "utilities.css";
@import "animations.css";

/* Components */
@import "components/buttons.css";
@import "components/forms.css";
@import "components/cards.css";
@import "components/header.css";
@import "components/hero.css";
@import "components/services.css";
@import "components/testimonials.css";
@import "components/footer.css";
```

(Exact filenames may differ; keep the intent.)

---

## 3. Tokens – Single Source of Truth

`tokens.css` is the **only file** that defines raw design values:

- **Typography scale** (`--text-xs`, `--text-sm`, …, `--text-display`), often using `clamp()` for fluid headings.
- **Spacing scale** (`--space-1` … `--space-24`) based on the 8px grid.
- **Colour tokens** (`--color-primary`, `--color-surface`, etc.), usually derived from branding HSL variables generated by `branding_css`.
- **Radius, shadows, animation easings**, etc.

All other CSS files must **only use tokens** via `var(--...)`:

```css
padding: var(--space-4);
background-color: var(--color-surface);
color: var(--color-text);
box-shadow: var(--shadow-sm);
```

**Absolutely no:**

- New hex colours (`#123456`) in component/layout CSS.
- New font sizes (`18px`, `2.25rem`, etc.) outside the token scale.
- New ad-hoc shadows or radii.

If you need a new value, add a token to `tokens.css` and then reference it.

---

## 4. Typography Roles → Classes

We don’t design “per block”. We design **roles** and reuse them everywhere.

### 4.1 Roles and mappings

These are the canonical roles and their classes:

- **Hero H1 / main page title**
  → `.heading-xl` (or `.heading-display` if that exists in the CSS)

- **Section heading (major)**
  → `.heading-lg`
  e.g. “Our Services”, “Testimonials”, “Why Choose Us”

- **Card / block heading (minor)**
  → `.heading-md`
  e.g. titles within service cards, testimonial author names if emphasised

- **Eyebrow / kicker label**
  → `.text-sm .text-muted`
  e.g. “Why choose us”, “Happy customers”, short label above a heading

- **Section intro / lead paragraph**
  → `.text-body .text-muted`
  e.g. the one or two lines of copy under a section heading

- **Body copy**
  → `.text-body`

- **Small meta / caption**
  → `.text-xs .text-muted`

### 4.2 Typography rules

- Every text element in a new block must be assigned one of these roles and use the mapped class(es).
- Component CSS **must not** set:

  - `font-family`
  - `font-size`
  - `line-height`
  - `letter-spacing`

Fonts and sizes come from:

- `branding_fonts` and `branding_css` (which configure `--font-heading`, `--font-body` and Google Fonts links from SiteSettings).
- The type scale tokens defined in `tokens.css`.

Changing fonts in Wagtail SiteSettings should update typography everywhere without touching component CSS.

---

## 5. Layout & Grid Patterns

### 5.1 Sections & containers

Every major block (hero, services, testimonials, trust strip, etc.) should follow:

```html
<section class="section [section--muted|section--inset]">
  <div class="container">…</div>
</section>
```

- `.section` controls vertical rhythm.
- `.section--muted` for subtle background emphasis (e.g. grey or tinted band).
- `.section--inset` for reduced vertical padding.
- `.container` constrains width and centres content.

### 5.2 Section Header Pattern (Shared)

All section blocks share a common header structure defined in `layout.css`. This ensures **consistent styling** for eyebrow labels, headings, and intro text across all sections.

**Classes:**

| Class               | Purpose                                                |
| ------------------- | ------------------------------------------------------ |
| `.section__header`  | Container for the header group (max-width, margin)     |
| `.section__eyebrow` | Pill-style label above heading (e.g. "Selected Works") |
| `.section__heading` | Main section heading with rich text support            |
| `.section__intro`   | Lead paragraph below heading                           |

**Usage in templates:**

```html
<section class="section gallery">
  <div class="container">
    <header class="section__header reveal-group">
      <span class="section__eyebrow">{{ self.eyebrow }}</span>
      <div class="section__heading">{{ self.heading|richtext }}</div>
      <p class="section__intro">{{ self.intro }}</p>
    </header>
    <!-- ... grid content ... -->
  </div>
</section>
```

**Dark theme support:**

For dark sections (e.g. testimonials), add `.section--dark` to the `<section>` element. The header styles automatically adapt:

```html
<section class="section section--dark testimonials">
  <!-- .section__eyebrow, .section__heading, etc. will use inverted colours -->
</section>
```

**Italic accent for emphasis:**

The `.section__heading` supports rich text with italic emphasis. Use `<em>` or `<i>` to highlight key words:

```html
<div class="section__heading">
  <p>A Showcase of <em>Precision</em> & Detail.</p>
</div>
```

Italicized words receive the accent colour (`--accent-pop`), creating visual hierarchy.

### 5.3 Grids for card-like blocks

We reuse a standard 1/2/3 grid pattern like the services and testimonials sections:

- **Mobile (< 768px):** 1 column
- **Tablet (≥ 768px):** 2 columns
- **Desktop (≥ 1024px):** 3 columns

Example (used by services/testimonials):

```css
.services__grid,
.testimonials__grid {
  display: grid;
  gap: var(--space-6);
  grid-template-columns: 1fr;
}

@media (min-width: 768px) {
  .services__grid,
  .testimonials__grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (min-width: 1024px) {
  .services__grid,
  .testimonials__grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}
```

New grids should **copy this pattern** with a namespaced class (e.g. `.trust-strip__grid`, `.faq__grid`).

### 5.4 Cards & components

- Use `.card` as the base for any card-like UI (service card, testimonial card, feature card, etc.).
- Card-specific tweaks (e.g. avatar positioning, rating stars) belong in the **component file** (`components/testimonials.css`), extending `.card` rather than replacing it.

---

## 6. Component CSS Rules

### 6.1 Where to put styles

- All block-specific CSS goes in `components/<block>.css`:

  - Hero → `components/hero.css`
  - Service cards → `components/services.css`
  - Testimonials → `components/testimonials.css`
  - Future: trust strip, CTA, FAQ, portfolio, etc.

- Add a corresponding `@import` entry in `main.css` if there isn’t one already.

### 6.2 What you’re allowed to write

✅ **Allowed in component CSS**

- Layout properties using tokens:

  ```css
  margin-bottom: var(--space-4);
  padding: var(--space-5);
  gap: var(--space-3);
  ```

- Colours via tokens:

  ```css
  background-color: var(--color-surface-elevated);
  color: var(--color-text-light);
  border-color: var(--color-border-subtle);
  ```

- Typography _structure_, not values:

  ```css
  .testimonial-card__quote p {
    /* It's okay to set weight/style here if needed */
    font-weight: var(--font-semibold);
  }
  ```

- Positioning, flex/grid, transforms, transitions, etc.

❌ **Not allowed in component CSS**

- `font-family: "Some Font";` (fonts come from branding).
- `font-size: 32px;` or `1.75rem;` (sizes come from the type scale; use `.heading-*` / `.text-*` classes).
- Raw colour literals: `#123456`, `rgb(…)`, `hsl(…)` (outside `tokens.css`).
- Inline styles in templates (`style="..."`).
- `!important` unless absolutely unavoidable and documented.

If you discover an old rule that breaks these guidelines, prefer to **refactor** it towards tokens during normal work, or at least add a `TODO` comment.

---

## 7. Agent Workflow for Implementing a Block

When an agent (human or AI) implements or updates a block:

### Step 1 – Understand the block

- Look at the design (reference HTML / Figma / premium trade example).
- Identify:

  - Section heading
  - Any eyebrow/label
  - Intro/lead text
  - Cards or items (titles, body text, meta)
  - Buttons/links

### Step 2 – Assign typography roles

For each text element:

- Assign a **role** (section heading, card heading, body, etc.).
- Apply the **mapped class** from the roles table:

  - Section heading → `.heading-lg`
  - Card heading → `.heading-md`
  - Eyebrow → `.text-sm .text-muted`
  - Body → `.text-body`

Do **not** choose a custom font size; choose the correct role.

### Step 3 – Structure the HTML

- Wrap the block in:

  ```html
  <section class="section [section--muted|section--inset]">
    <div class="container">…</div>
  </section>
  ```

- Use `.card` for card-like elements.

- For multiple cards, use a grid class like `.services__grid` or `.testimonials__grid` as a template and rename appropriately.

### Step 4 – Add/adjust component CSS

- Open `components/<block>.css` (or create it).
- Add styles using **only** tokens and utilities, extending existing patterns:

  - Use `var(--space-*)` for spacing.
  - Use `var(--color-*)` and HSL-derived branding variables for colour.
  - Use `var(--shadow-*)` for shadows.

- Don’t change fonts/colours directly; rely on tokens and classes.

### Step 5 – Run the Token Compliance Checklist

Before you consider the block “done”, run through the checklist below.

---

## 8. Token Compliance Checklist

Use this list when reviewing PRs or finishing a task.

**Templates**

- [ ] No inline `style="..."` attributes.
- [ ] Section layouts follow `.section` + `.container`.
- [ ] Headings use `.heading-*` classes from the roles table.
- [ ] Body text uses `.text-body` / `.text-body .text-muted`.

**CSS**

- [ ] New styles live in the correct partial (`components/<block>.css`, `layout.css`, etc.).
- [ ] No new raw hex/RGB colours outside `tokens.css`.
- [ ] No `font-family`, `font-size`, `line-height`, or `letter-spacing` in component CSS.
- [ ] All new spacing uses `var(--space-*)` tokens.
- [ ] All new colours use `var(--color-*)` or branding-derived variables from `branding_css`.
- [ ] Grids follow the 1/2/3 column pattern unless there’s a deliberate documented exception.

**Branding behaviour**

- [ ] Changing fonts/colours in `SiteSettings` still updates the new block (no hard-coded design values blocking it).

---

## 9. Notes for Client Projects & Overrides (Future-facing)

For downstream projects using `sum_core`:

- Prefer to override design by:

  - Adjusting `SiteSettings` colours/fonts.
  - Extending tokens in `tokens.css` via extra CSS loaded after `main.css`.
  - Adding project-specific component CSS files.

- Avoid editing `sum_core` directly; treat this package as a stable core.

(A more detailed “override patterns” doc can build on this in a later milestone.)

---
