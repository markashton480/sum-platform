# **[DOC-002]: Lock Redis Runtime & Health Semantics**

### **Objective**

Formally lock the **runtime semantics** introduced by `docs/dev/CM/CM-M6-02.md` so Redis cannot drift back into an “optional” or ambiguous state, and `/health/` behaviour is unambiguous for operators, agents, and future maintainers.

This task is **documentation-only**.
No infrastructure changes, no code changes, no scripts.

---

## **Context** (from SSOT / Post-MVP Plan)

- `docs/dev/CM/CM-M6-02.md` established Redis as a **baseline runtime dependency**:

  - installed by default
  - required for cache + runtime assumptions
  - Celery remains feature-optional but Redis-dependent

- Current documentation still allows room for interpretation around:

  - whether Redis is _truly_ baseline vs “optional”
  - whether Redis failure is **degraded** or **unhealthy**

- This task exists solely to **freeze the semantics**, not to revisit implementation.

**References**

- POST-MVP_BIG-PLAN v4.1 (final pre-M6)
- CM-M6-02 transcript + follow-up report

---

## **Scope**

### **IN SCOPE**

- Clarifying documentation wording
- Locking semantic expectations
- Preventing future reinterpretation by agents

### **OUT OF SCOPE**

- Any infrastructure changes
- Any Redis config changes
- Any health check code changes
- Any Celery changes

---

## **Documentation Updates Required**

### **1) VPS Golden Path – Runtime Baseline**

**Target doc:** VPS golden path / deployment docs

Add an explicit statement:

> **Redis is part of the baseline SUM runtime.**
> All production deployments assume Redis is installed, running, and reachable.
> If Redis is unavailable, the runtime is considered broken.

Purpose:

- Eliminate any lingering “optional Redis” interpretation
- Align operator expectations with actual system behaviour

---

### **2) Health Semantics – Redis Failure Mapping**

**Target doc:** Health semantics / ops documentation

Add an explicit rule:

> **Redis failure results in `/health/` reporting `unhealthy` (HTTP 503).**
> This reflects a broken baseline runtime, not a degraded feature.

Purpose:

- Prevent future downgrading of Redis failure to “degraded”
- Keep health semantics binary and boring

---

### **3) Celery Relationship Clarification**

**Target doc:** Runtime stack / background jobs section

Add a single clarifying sentence:

> **Celery is an optional feature; Redis is not.**
> If Celery is enabled, it depends on Redis, but Redis is required regardless of whether Celery is enabled.

Purpose:

- Prevent Redis being treated as “only needed if Celery is on”
- Preserve clean dependency direction

---

## **Acceptance Criteria**

- Documentation clearly states Redis is **baseline-critical**
- Documentation clearly states Redis failure → **unhealthy (503)**
- Celery vs Redis relationship is explicit and non-ambiguous
- No references remain that imply Redis is optional for production
- No implementation changes are introduced

---

## **Dependencies & Prerequisites**

- CM-M6-02 must be complete (it is)
- `docs/dev/master-docs/POST-MVP_BIG-PLAN.md` v4.1 is the authoritative reference

---

## **Testing / Verification**

**Manual verification only**

- Read docs as if you are a new operator:

  - No ambiguity about Redis
  - No branching logic suggested

- Sanity check wording against CM-M6-02 behaviour

(No automated tests required — documentation task)

---

## **Estimated Complexity**

- **Time:** XS
- **Risk:** None
- **Suggested Model:** Claude Sonnet / GPT-5.1 (low complexity)

---

## **Notes**

This task exists specifically to:

- prevent semantic drift
- stop future “is Redis optional?” debates
- keep the SUM runtime model **simple, deterministic, and boring**
